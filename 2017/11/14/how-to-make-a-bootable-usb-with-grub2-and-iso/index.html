<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>How to make a bootable USB with GRUB2 and ISO</title><meta name="description" content="Do you have multiple ISO files to install, with quite enough storage of USB stick? You’ll want to install all of them with a single USB stick. Here’s how. Formatting USB disk First, plug in your USB stick and find it from your Linux machine: $ sudo fdisk -l Disk /dev/sda: 20 GiB, 21474836480 bytes, 41943040 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disklabel type: dos Disk identifier: 0x4d149927 Device Boot Start End Sectors Size Id Type /dev/sda1 * 2048 39845887 39843840 19G 83 Linux /dev/sda2 39847934 41940991 2093058 1022M 5 Extended /dev/sda5 39847936 41940991 2093056 1022M 82 Linux swap / Solaris Disk /dev/sdb: 14.6 GiB, 15664676864 bytes, 30595072 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disklabel type: gpt Disk identifier: 4788154A-7BD2-4A06-945B-5980E828C8C5 Device Start End Sectors Size Type /dev/sdb1 40 409639 409600 200M EFI System /dev/sdb2 411648 30593023 30181376 14.4G Microsoft basic data In my case, it’s /dev/sdb. Let’s format it with fdisk. When you run fdisk /dev/sdb, you can print help menu: $ sudo fdisk /dev/sdb Welcome to fdisk (util-linux 2.27.1). Changes will remain in memory only, until you decide to write them. Be careful before using the write command. Command (m for help): m Help: Generic d delete a partition F list free unpartitioned space l list known partition types n add a new partition p print the partition table t change a partition type v verify the partition table i print information about a partition Misc m print this menu x extra functionality (experts only) Script I load disk layout from sfdisk script file O dump disk layout to sfdisk script file Save &amp;amp; Exit w write table to disk and exit q quit without saving changes Create a new label g create a new empty GPT partition table G create a new empty SGI (IRIX) partition table o create a new empty DOS partition table s create a new empty Sun partition table Now we can start! $ sudo fdisk /dev/sdb Welcome to fdisk (util-linux 2.27.1). Changes will remain in memory only, until you decide to write them. Be careful before using the write command. Command (m for help): o Created a new DOS disklabel with disk identifier 0x8c9faeb0. Command (m for help): n Partition type p primary (0 primary, 0 extended, 4 free) e extended (container for logical partitions) Select (default p): Using default response p. Partition number (1-4, default 1): First sector (2048-30595071, default 2048): Last sector, +sectors or +size{K,M,G,T,P} (2048-30595071, default 30595071): Created a new partition 1 of type &#39;Linux&#39; and of size 14.6 GiB. Command (m for help): t Selected partition 1 Partition type (type L to list all types): c Changed type of partition &#39;Linux&#39; to &#39;W95 FAT32 (LBA)&#39;. Command (m for help): a Selected partition 1 The bootable flag on partition 1 is enabled now. Command (m for help): w The partition table has been altered. Calling ioctl() to re-read partition table. Syncing disks. We’ve just created one bootable FAT partition, and that’ll be /dev/sdb1. Let’s create an MS-DOS filesystem in it. This will take a while. $ sudo mkfs.vfat -F 32 /dev/sdb1 mkfs.fat 3.0.28 (2015-05-16) Now you can mount that partition and we’re ready to install GRUB2 in it. sudo make /mnt/usb sudo mount /dev/sdb1 /mnt/usb Installing GRUB2 Since we’re installing GRUB2 into USB stick, we specify --removable flag. Also specify --boot-directory so that GRUB2 is installed to there instead of /boot/grub. $ sudo grub-install --removable --boot-directory=/mnt/usb/boot /dev/sdb Installing for i386-pc platform. Installation finished. No error reported. We’ll add grub.cfg file under /mnt/usb/boot/grub/ directory. It defines selectable menus and the booting method of each entry. This time I’ll add Ubuntu Desktop ISO for i386 platform. set timeout=5 set default=0 menuentry &quot;Ubuntu Desktop 16.04.3 LTS i386&quot; { set isofile=&quot;/iso/ubuntu-16.04.3-desktop-i386.iso&quot; loopback loop $isofile linux (loop)/casper/vmlinuz boot=casper file=/preseed/ubuntu.seed iso-scan/filename=$isofile noeject noprompt splash -- initrd (loop)/casper/initrd.lz } menuentry &quot;Ubuntu Desktop 16.04.3 LTS amd64&quot; { set isofile=&quot;/iso/ubuntu-16.04.3-desktop-amd64.iso&quot; loopback loop $isofile linux (loop)/casper/vmlinuz.efi boot=casper file=/preseed/ubuntu.seed iso-scan/filename=$isofile noeject noprompt splash -- initrd (loop)/casper/initrd.lz } menuentry &quot;Ubuntu Server 16.04.3 LTS i386&quot; { set isofile=&quot;/iso/ubuntu-16.04.3-server-i386.iso&quot; loopback loop $isofile linux (loop)/install/vmlinuz boot=casper file=/preseed/ubuntu-server.seed iso-scan/filename=$isofile noeject noprompt splash -- initrd (loop)/install/initrd.gz } menuentry &quot;Ubuntu Server 16.04.3 LTS amd64&quot; { set isofile=&quot;/iso/ubuntu-16.04.3-server-amd64.iso&quot; loopback loop $isofile linux (loop)/install/vmlinuz boot=casper file=/preseed/ubuntu-server.seed iso-scan/filename=$isofile noeject noprompt splash -- initrd (loop)/install/initrd.gz } menuentry &quot;Linux Mint 18.2 Cinnamon 32-bit&quot; { set isofile=&quot;/iso/linuxmint-18.2-cinnamon-32bit.iso&quot; loopback loop $isofile linux (loop)/casper/vmlinuz boot=casper file=/preseed/linuxmint.seed iso-scan/filename=$isofile noeject noprompt splash -- initrd (loop)/casper/initrd.lz } menuentry &quot;Custom ELF&quot; { elffile=&quot;/elf/custom.elf&quot; multiboot $elffile } In the first menuentry, isofile points to /iso/ubuntu-16.04.3-desktop-i386.iso, and it’s relative path of the USB stick. Create /mnt/usb/iso/ directory, and put the ISO files under there. You may need to look inside of ISO file to find where is vmlinuz* and initrd.* files. Try this: isoinfo -l -i myimage.iso As the similar way, you can also make it to boot from ELF file. Just put the ELF file that supports Multiboot under /mnt/usb/elf/ directory, and edit the menuentry properly. After editing is done, unmount the disk and use it right away! sudo umount /dev/sdb1 Troubleshooting If your screen goes black on boot, try with nomodeset: linux ... noeject noprompt splash nomodeset -- See also Grub2/ISOBoot/Examples Ubuntu Manpage: casper"><link rel="stylesheet" href="/assets/main.css"><link rel="canonical" href="https://yous.be/2017/11/14/how-to-make-a-bootable-usb-with-grub2-and-iso/"><link rel="alternate" type="application/rss+xml" title="Yous" href="https://yous.be/atom.xml"><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="icon" type="image/png" href="/icon-192x192.png"><link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png"><link rel="apple-touch-icon" sizes="167x167" href="/apple-touch-icon-167x167.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png"><link rel="mask-icon" color="#2568ba" href="/safari-pinned-tab.svg"><meta name="msapplication-TileColor" content="#2568ba"><meta name="msapplication-TileImage" content="/mstile-144x144.png"><meta property="fb:admins" content="100001802412550"><meta property="og:title" content="How to make a bootable USB with GRUB2 and ISO"><meta property="og:site_name" content="Yous"><meta property="og:url" content="https://yous.be/2017/11/14/how-to-make-a-bootable-usb-with-grub2-and-iso/"><meta property="og:description" content="Do you have multiple ISO files to install, with quite enough storage of USB stick? You’ll want to install all of them with a single USB stick. Here’s how. Formatting USB disk First, plug in your USB stick and find it from your Linux machine: $ sudo fdisk -l Disk /dev/sda: 20 GiB, 21474836480 bytes, 41943040 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disklabel type: dos Disk identifier: 0x4d149927 Device Boot Start End Sectors Size Id Type /dev/sda1 * 2048 39845887 39843840 19G 83 Linux /dev/sda2 39847934 41940991 2093058 1022M 5 Extended /dev/sda5 39847936 41940991 2093056 1022M 82 Linux swap / Solaris Disk /dev/sdb: 14.6 GiB, 15664676864 bytes, 30595072 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disklabel type: gpt Disk identifier: 4788154A-7BD2-4A06-945B-5980E828C8C5 Device Start End Sectors Size Type /dev/sdb1 40 409639 409600 200M EFI System /dev/sdb2 411648 30593023 30181376 14.4G Microsoft basic data In my case, it’s /dev/sdb. Let’s format it with fdisk. When you run fdisk /dev/sdb, you can print help menu: $ sudo fdisk /dev/sdb Welcome to fdisk (util-linux 2.27.1). Changes will remain in memory only, until you decide to write them. Be careful before using the write command. Command (m for help): m Help: Generic d delete a partition F list free unpartitioned space l list known partition types n add a new partition p print the partition table t change a partition type v verify the partition table i print information about a partition Misc m print this menu x extra functionality (experts only) Script I load disk layout from sfdisk script file O dump disk layout to sfdisk script file Save &amp;amp; Exit w write table to disk and exit q quit without saving changes Create a new label g create a new empty GPT partition table G create a new empty SGI (IRIX) partition table o create a new empty DOS partition table s create a new empty Sun partition table Now we can start! $ sudo fdisk /dev/sdb Welcome to fdisk (util-linux 2.27.1). Changes will remain in memory only, until you decide to write them. Be careful before using the write command. Command (m for help): o Created a new DOS disklabel with disk identifier 0x8c9faeb0. Command (m for help): n Partition type p primary (0 primary, 0 extended, 4 free) e extended (container for logical partitions) Select (default p): Using default response p. Partition number (1-4, default 1): First sector (2048-30595071, default 2048): Last sector, +sectors or +size{K,M,G,T,P} (2048-30595071, default 30595071): Created a new partition 1 of type &#39;Linux&#39; and of size 14.6 GiB. Command (m for help): t Selected partition 1 Partition type (type L to list all types): c Changed type of partition &#39;Linux&#39; to &#39;W95 FAT32 (LBA)&#39;. Command (m for help): a Selected partition 1 The bootable flag on partition 1 is enabled now. Command (m for help): w The partition table has been altered. Calling ioctl() to re-read partition table. Syncing disks. We’ve just created one bootable FAT partition, and that’ll be /dev/sdb1. Let’s create an MS-DOS filesystem in it. This will take a while. $ sudo mkfs.vfat -F 32 /dev/sdb1 mkfs.fat 3.0.28 (2015-05-16) Now you can mount that partition and we’re ready to install GRUB2 in it. sudo make /mnt/usb sudo mount /dev/sdb1 /mnt/usb Installing GRUB2 Since we’re installing GRUB2 into USB stick, we specify --removable flag. Also specify --boot-directory so that GRUB2 is installed to there instead of /boot/grub. $ sudo grub-install --removable --boot-directory=/mnt/usb/boot /dev/sdb Installing for i386-pc platform. Installation finished. No error reported. We’ll add grub.cfg file under /mnt/usb/boot/grub/ directory. It defines selectable menus and the booting method of each entry. This time I’ll add Ubuntu Desktop ISO for i386 platform. set timeout=5 set default=0 menuentry &quot;Ubuntu Desktop 16.04.3 LTS i386&quot; { set isofile=&quot;/iso/ubuntu-16.04.3-desktop-i386.iso&quot; loopback loop $isofile linux (loop)/casper/vmlinuz boot=casper file=/preseed/ubuntu.seed iso-scan/filename=$isofile noeject noprompt splash -- initrd (loop)/casper/initrd.lz } menuentry &quot;Ubuntu Desktop 16.04.3 LTS amd64&quot; { set isofile=&quot;/iso/ubuntu-16.04.3-desktop-amd64.iso&quot; loopback loop $isofile linux (loop)/casper/vmlinuz.efi boot=casper file=/preseed/ubuntu.seed iso-scan/filename=$isofile noeject noprompt splash -- initrd (loop)/casper/initrd.lz } menuentry &quot;Ubuntu Server 16.04.3 LTS i386&quot; { set isofile=&quot;/iso/ubuntu-16.04.3-server-i386.iso&quot; loopback loop $isofile linux (loop)/install/vmlinuz boot=casper file=/preseed/ubuntu-server.seed iso-scan/filename=$isofile noeject noprompt splash -- initrd (loop)/install/initrd.gz } menuentry &quot;Ubuntu Server 16.04.3 LTS amd64&quot; { set isofile=&quot;/iso/ubuntu-16.04.3-server-amd64.iso&quot; loopback loop $isofile linux (loop)/install/vmlinuz boot=casper file=/preseed/ubuntu-server.seed iso-scan/filename=$isofile noeject noprompt splash -- initrd (loop)/install/initrd.gz } menuentry &quot;Linux Mint 18.2 Cinnamon 32-bit&quot; { set isofile=&quot;/iso/linuxmint-18.2-cinnamon-32bit.iso&quot; loopback loop $isofile linux (loop)/casper/vmlinuz boot=casper file=/preseed/linuxmint.seed iso-scan/filename=$isofile noeject noprompt splash -- initrd (loop)/casper/initrd.lz } menuentry &quot;Custom ELF&quot; { elffile=&quot;/elf/custom.elf&quot; multiboot $elffile } In the first menuentry, isofile points to /iso/ubuntu-16.04.3-desktop-i386.iso, and it’s relative path of the USB stick. Create /mnt/usb/iso/ directory, and put the ISO files under there. You may need to look inside of ISO file to find where is vmlinuz* and initrd.* files. Try this: isoinfo -l -i myimage.iso As the similar way, you can also make it to boot from ELF file. Just put the ELF file that supports Multiboot under /mnt/usb/elf/ directory, and edit the menuentry properly. After editing is done, unmount the disk and use it right away! sudo umount /dev/sdb1 Troubleshooting If your screen goes black on boot, try with nomodeset: linux ... noeject noprompt splash nomodeset -- See also Grub2/ISOBoot/Examples Ubuntu Manpage: casper"><meta property="og:image" content="http://yous.be/images/about/yous.png"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="How to make a bootable USB with GRUB2 and ISO"><meta name="twitter:description" content="Do you have multiple ISO files to install, with quite enough storage of USB stick? You’ll want to install all of them with a single USB stick. Here’s how. Formatting USB disk First, plug in your US..."><meta name="twitter:image:src" content="http://yous.be/images/about/yous.png"> <script type="text/javascript"> WebFontConfig = { google: { families: [ 'Bitter:400,700,400italic:latin' ] } }; (function() { var wf = document.createElement('script'); wf.src = ('https:' == document.location.protocol ? 'https' : 'http') + '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js'; wf.type = 'text/javascript'; wf.async = 'true'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(wf, s); })(); </script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-43111808-1', 'auto'); ga('send', 'pageview'); </script><body><header class="site-header"><div class="wrapper"> <a class="site-title" href="/">Yous</a><nav class="site-nav"> <a class="page-link" href="/about/">About</a> <a class="page-link" href="/archives/">Archives</a></nav></div></header><main class="page-content" aria-label="Content"><div class="wrapper"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header class="post-header"><h1 class="post-title" itemprop="name headline">How to make a bootable USB with GRUB2 and ISO</h1><p class="post-meta"><time datetime="2017-11-14T03:23:14+00:00" itemprop="datePublished">Nov 14, 2017</time></header><div class="post-content" itemprop="articleBody"><p>Do you have multiple ISO files to install, with quite enough storage of USB stick? You’ll want to install all of them with a single USB stick. Here’s how.<h2>Formatting USB disk</h2><p>First, plug in your USB stick and find it from your Linux machine:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>fdisk <span class="nt">-l</span>
Disk /dev/sda: 20 GiB, 21474836480 bytes, 41943040 sectors
Units: sectors of 1 <span class="k">*</span> 512 <span class="o">=</span> 512 bytes
Sector size <span class="o">(</span>logical/physical<span class="o">)</span>: 512 bytes / 512 bytes
I/O size <span class="o">(</span>minimum/optimal<span class="o">)</span>: 512 bytes / 512 bytes
Disklabel <span class="nb">type</span>: dos
Disk identifier: 0x4d149927

Device     Boot    Start      End  Sectors  Size Id Type
/dev/sda1  <span class="k">*</span>        2048 39845887 39843840   19G 83 Linux
/dev/sda2       39847934 41940991  2093058 1022M  5 Extended
/dev/sda5       39847936 41940991  2093056 1022M 82 Linux swap / Solaris


Disk /dev/sdb: 14.6 GiB, 15664676864 bytes, 30595072 sectors
Units: sectors of 1 <span class="k">*</span> 512 <span class="o">=</span> 512 bytes
Sector size <span class="o">(</span>logical/physical<span class="o">)</span>: 512 bytes / 512 bytes
I/O size <span class="o">(</span>minimum/optimal<span class="o">)</span>: 512 bytes / 512 bytes
Disklabel <span class="nb">type</span>: gpt
Disk identifier: 4788154A-7BD2-4A06-945B-5980E828C8C5

Device      Start      End  Sectors  Size Type
/dev/sdb1      40   409639   409600  200M EFI System
/dev/sdb2  411648 30593023 30181376 14.4G Microsoft basic data
</code></pre></div></div><p>In my case, it’s <code class="highlighter-rouge">/dev/sdb</code>. Let’s format it with <code class="highlighter-rouge">fdisk</code>. When you run <code class="highlighter-rouge">fdisk /dev/sdb</code>, you can print help menu:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>fdisk /dev/sdb

Welcome to fdisk <span class="o">(</span>util-linux 2.27.1<span class="o">)</span><span class="nb">.</span>
Changes will remain <span class="k">in </span>memory only, <span class="k">until </span>you decide to write them.
Be careful before using the write command.


Command <span class="o">(</span>m <span class="k">for </span><span class="nb">help</span><span class="o">)</span>: m

Help:

  Generic
   d   delete a partition
   F   list free unpartitioned space
   l   list known partition types
   n   add a new partition
   p   print the partition table
   t   change a partition <span class="nb">type
   </span>v   verify the partition table
   i   print information about a partition

  Misc
   m   print this menu
   x   extra functionality <span class="o">(</span>experts only<span class="o">)</span>

  Script
   I   load disk layout from sfdisk script file
   O   dump disk layout to sfdisk script file

  Save &amp; Exit
   w   write table to disk and <span class="nb">exit
   </span>q   quit without saving changes

  Create a new label
   g   create a new empty GPT partition table
   G   create a new empty SGI <span class="o">(</span>IRIX<span class="o">)</span> partition table
   o   create a new empty DOS partition table
   s   create a new empty Sun partition table
</code></pre></div></div><p>Now we can start!<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>fdisk /dev/sdb

Welcome to fdisk <span class="o">(</span>util-linux 2.27.1<span class="o">)</span><span class="nb">.</span>
Changes will remain <span class="k">in </span>memory only, <span class="k">until </span>you decide to write them.
Be careful before using the write command.


Command <span class="o">(</span>m <span class="k">for </span><span class="nb">help</span><span class="o">)</span>: o
Created a new DOS disklabel with disk identifier 0x8c9faeb0.

Command <span class="o">(</span>m <span class="k">for </span><span class="nb">help</span><span class="o">)</span>: n
Partition <span class="nb">type
   </span>p   primary <span class="o">(</span>0 primary, 0 extended, 4 free<span class="o">)</span>
   e   extended <span class="o">(</span>container <span class="k">for </span>logical partitions<span class="o">)</span>
Select <span class="o">(</span>default p<span class="o">)</span>:

Using default response p.
Partition number <span class="o">(</span>1-4, default 1<span class="o">)</span>:
First sector <span class="o">(</span>2048-30595071, default 2048<span class="o">)</span>:
Last sector, +sectors or +size<span class="o">{</span>K,M,G,T,P<span class="o">}</span> <span class="o">(</span>2048-30595071, default 30595071<span class="o">)</span>:

Created a new partition 1 of <span class="nb">type</span> <span class="s1">'Linux'</span> and of size 14.6 GiB.

Command <span class="o">(</span>m <span class="k">for </span><span class="nb">help</span><span class="o">)</span>: t
Selected partition 1
Partition <span class="nb">type</span> <span class="o">(</span><span class="nb">type </span>L to list all types<span class="o">)</span>: c
Changed <span class="nb">type </span>of partition <span class="s1">'Linux'</span> to <span class="s1">'W95 FAT32 (LBA)'</span><span class="nb">.</span>

Command <span class="o">(</span>m <span class="k">for </span><span class="nb">help</span><span class="o">)</span>: a
Selected partition 1
The bootable flag on partition 1 is enabled now.

Command <span class="o">(</span>m <span class="k">for </span><span class="nb">help</span><span class="o">)</span>: w
The partition table has been altered.
Calling ioctl<span class="o">()</span> to re-read partition table.
Syncing disks.
</code></pre></div></div><p>We’ve just created one bootable FAT partition, and that’ll be <code class="highlighter-rouge">/dev/sdb1</code>. Let’s create an MS-DOS filesystem in it. This will take a while.<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>mkfs.vfat <span class="nt">-F</span> 32 /dev/sdb1
mkfs.fat 3.0.28 <span class="o">(</span>2015-05-16<span class="o">)</span>
</code></pre></div></div><p>Now you can mount that partition and we’re ready to install GRUB2 in it.<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>make /mnt/usb
<span class="nb">sudo </span>mount /dev/sdb1 /mnt/usb
</code></pre></div></div><h2>Installing GRUB2</h2><p>Since we’re installing GRUB2 into USB stick, we specify <code class="highlighter-rouge">--removable</code> flag. Also specify <code class="highlighter-rouge">--boot-directory</code> so that GRUB2 is installed to there instead of <code class="highlighter-rouge">/boot/grub</code>.<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>grub-install <span class="nt">--removable</span> <span class="nt">--boot-directory</span><span class="o">=</span>/mnt/usb/boot /dev/sdb
Installing <span class="k">for </span>i386-pc platform.
Installation finished. No error reported.
</code></pre></div></div><p>We’ll add <code class="highlighter-rouge">grub.cfg</code> file under <code class="highlighter-rouge">/mnt/usb/boot/grub/</code> directory. It defines selectable menus and the booting method of each entry. This time I’ll add Ubuntu Desktop ISO for i386 platform.<pre><code class="language-grub">set timeout=5
set default=0

menuentry "Ubuntu Desktop 16.04.3 LTS i386" {
  set isofile="/iso/ubuntu-16.04.3-desktop-i386.iso"
  loopback loop $isofile
  linux (loop)/casper/vmlinuz boot=casper file=/preseed/ubuntu.seed iso-scan/filename=$isofile noeject noprompt splash --
  initrd (loop)/casper/initrd.lz
}

menuentry "Ubuntu Desktop 16.04.3 LTS amd64" {
  set isofile="/iso/ubuntu-16.04.3-desktop-amd64.iso"
  loopback loop $isofile
  linux (loop)/casper/vmlinuz.efi boot=casper file=/preseed/ubuntu.seed iso-scan/filename=$isofile noeject noprompt splash --
  initrd (loop)/casper/initrd.lz
}

menuentry "Ubuntu Server 16.04.3 LTS i386" {
  set isofile="/iso/ubuntu-16.04.3-server-i386.iso"
  loopback loop $isofile
  linux (loop)/install/vmlinuz boot=casper file=/preseed/ubuntu-server.seed iso-scan/filename=$isofile noeject noprompt splash --
  initrd (loop)/install/initrd.gz
}

menuentry "Ubuntu Server 16.04.3 LTS amd64" {
  set isofile="/iso/ubuntu-16.04.3-server-amd64.iso"
  loopback loop $isofile
  linux (loop)/install/vmlinuz boot=casper file=/preseed/ubuntu-server.seed iso-scan/filename=$isofile noeject noprompt splash --
  initrd (loop)/install/initrd.gz
}

menuentry "Linux Mint 18.2 Cinnamon 32-bit" {
  set isofile="/iso/linuxmint-18.2-cinnamon-32bit.iso"
  loopback loop $isofile
  linux (loop)/casper/vmlinuz boot=casper file=/preseed/linuxmint.seed iso-scan/filename=$isofile noeject noprompt splash --
  initrd (loop)/casper/initrd.lz
}

menuentry "Custom ELF" {
  elffile="/elf/custom.elf"
  multiboot $elffile
}
</code></pre><p>In the first menuentry, <code class="highlighter-rouge">isofile</code> points to <code class="highlighter-rouge">/iso/ubuntu-16.04.3-desktop-i386.iso</code>, and it’s relative path of the USB stick. Create <code class="highlighter-rouge">/mnt/usb/iso/</code> directory, and put the ISO files under there.<p>You may need to look inside of ISO file to find where is <code class="highlighter-rouge">vmlinuz*</code> and <code class="highlighter-rouge">initrd.*</code> files. Try this:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>isoinfo <span class="nt">-l</span> <span class="nt">-i</span> myimage.iso
</code></pre></div></div><p>As the similar way, you can also make it to boot from ELF file. Just put the ELF file that supports <a href="https://www.gnu.org/software/grub/manual/multiboot/multiboot.html">Multiboot</a> under <code class="highlighter-rouge">/mnt/usb/elf/</code> directory, and edit the menuentry properly.<p>After editing is done, unmount the disk and use it right away!<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>umount /dev/sdb1
</code></pre></div></div><h2>Troubleshooting</h2><p>If your screen goes black on boot, try with <code class="highlighter-rouge">nomodeset</code>:<pre><code class="language-grub">linux ... noeject noprompt splash nomodeset --
</code></pre><h2>See also</h2><ul><li><a href="https://help.ubuntu.com/community/Grub2/ISOBoot/Examples">Grub2/ISOBoot/Examples</a><li><a href="http://manpages.ubuntu.com/manpages/xenial/man7/casper.7.html">Ubuntu Manpage: casper</a></ul></div></article></div></main><footer class="site-footer"><div class="wrapper"><p> Content on this site is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a><br /> &copy; 2013&ndash;2017 - <a href="/about/">Yous</a> - Powered by <a href="https://jekyllrb.com">Jekyll</a> &amp; <a href="https://github.com/yous/whiteglass">whiteglass</a> - Subscribe via <a href="https://yous.be/atom.xml">RSS</a></div></footer>
